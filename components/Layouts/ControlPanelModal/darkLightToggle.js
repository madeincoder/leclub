"use client";

import { useState, useEffect } from "react";
import styles from "./dark-light-toggle.module.scss";

const DarkAndLightModeToggle = () => {
  // Light/Dark Mode
  const [isDarkMode, setIsDarkMode] = useState(false);

  useEffect(() => {
    // Retrieve the user's preference from local storage
    const storedPreference = localStorage.getItem("theme");
    if (storedPreference === "dark") {
      setIsDarkMode(true);
    }
  }, []);

  const handleToggle = () => {
    setIsDarkMode(!isDarkMode);
  };

  useEffect(() => {
    // Update the user's preference in local storage
    localStorage.setItem("theme", isDarkMode ? "dark" : "light");

    // Update the class on the <html> element to apply the selected mode
    const htmlElement = document.querySelector("html");
    if (isDarkMode) {
      htmlElement.classList.add("dark");
    } else {
      htmlElement.classList.remove("dark");
    }
  }, [isDarkMode]);

  return (
    <div className={styles.darkModeBox}>
      <button
        onClick={handleToggle}
        className={`${styles.toggleSwitch} ${
          isDarkMode ? styles.darkMode : styles.lightMode
        } ml-2`}
        aria-label={`Switch to ${isDarkMode ? "Light" : "Dark"} Mode`}
      >
        <span className="sr-only">
          Switch to {isDarkMode ? "Light" : "Dark"} Mode
        </span>

        <span className={styles.toggleTrack}>
          {/* Sun/Moon Icon */}
          <span className={styles.icon}>
            {isDarkMode ? (
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                strokeWidth="2"
                strokeLinecap="round"
                strokeLinejoin="round"
                className={styles.moonIcon}
              >
                <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z" />
              </svg>
            ) : (
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                strokeWidth="2"
                strokeLinecap="round"
                strokeLinejoin="round"
                className={styles.sunIcon}
              >
                <circle cx="12" cy="12" r="4" />
                <path d="M12 2v2" />
                <path d="M12 20v2" />
                <path d="m4.93 4.93 1.41 1.41" />
                <path d="m17.66 17.66 1.41 1.41" />
                <path d="M2 12h2" />
                <path d="M20 12h2" />
                <path d="m6.34 17.66-1.41 1.41" />
                <path d="m19.07 4.93-1.41 1.41" />
              </svg>
            )}
          </span>

          {/* Toggle Button */}
          <span className={styles.toggleButton}></span>
        </span>
      </button>
    </div>
  );
};

export default DarkAndLightModeToggle;
